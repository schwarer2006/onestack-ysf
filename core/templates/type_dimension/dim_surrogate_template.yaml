# ---
# name: dim_surrogate_template
# type: dimension
# version: 1.0.0
# description: Dimension mit Surrogate Key, SCD2 und Hash-Ãœberwachung
# ---

type: dimension
surrogate_key: customer_sid
natural_key: customer_id
scd_type: 2
hash_column: row_hash
effective_date_column: valid_from
expiry_date_column: valid_to
is_current_column: is_current

columns:
  - name: customer_sid
    type: integer
    role: surrogate_key
    generated: true

  - name: customer_id
    type: string
    role: business_key

  - name: first_name
    type: string

  - name: last_name
    type: string

  - name: email
    type: string

  - name: valid_from
    type: date

  - name: valid_to
    type: date

  - name: is_current
    type: boolean

  - name: row_hash
    type: string
    role: hash
